import{a as i,b as r,c as D,d as f}from"./chunk-JUUAJO3J.js";var C,u,w,H,E=0,U=[],g=[],S=i.__b,N=i.__r,M=i.diffed,I=i.__c,R=i.unmount;function x(e,n){i.__h&&i.__h(u,e,E||n),E=0;var t=u.__H||(u.__H={__:[],__h:[]});return e>=t.__.length&&t.__.push({__V:g}),t.__[e]}function v(e){return E=1,ee(O,e)}function ee(e,n,t){var o=x(C++,2);return o.t=e,o.__c||(o.__=[t?t(n):O(void 0,n),function(a){var s=o.t(o.__[0],a);o.__[0]!==s&&(o.__=[s,o.__[1]],o.__c.setState({}))}],o.__c=u),o.__}function d(e,n){var t=x(C++,3);!i.__s&&z(t.__H,n)&&(t.__=e,t.u=n,u.__H.__h.push(t))}function ne(e,n){var t=x(C++,7);return z(t.__H,n)?(t.__V=e(),t.u=n,t.__h=e,t.__V):t.__}function Z(e,n){return E=8,ne(function(){return e},n)}function L(e){var n=u.context[e.__c],t=x(C++,9);return t.c=e,n?(t.__==null&&(t.__=!0,n.sub(u)),n.props.value):e.__}function te(){for(var e;e=U.shift();)if(e.__P)try{e.__H.__h.forEach(P),e.__H.__h.forEach(A),e.__H.__h=[]}catch(n){e.__H.__h=[],i.__e(n,e.__v)}}i.__b=function(e){u=null,S&&S(e)},i.__r=function(e){N&&N(e),C=0;var n=(u=e.__c).__H;n&&(w===u?(n.__h=[],u.__h=[],n.__.forEach(function(t){t.__V=g,t.u=void 0})):(n.__h.forEach(P),n.__h.forEach(A),n.__h=[])),w=u},i.diffed=function(e){M&&M(e);var n=e.__c;n&&n.__H&&(n.__H.__h.length&&(U.push(n)!==1&&H===i.requestAnimationFrame||((H=i.requestAnimationFrame)||function(t){var o,a=function(){clearTimeout(s),T&&cancelAnimationFrame(o),setTimeout(t)},s=setTimeout(a,100);T&&(o=requestAnimationFrame(a))})(te)),n.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.__V!==g&&(t.__=t.__V),t.u=void 0,t.__V=g})),w=u=null},i.__c=function(e,n){n.some(function(t){try{t.__h.forEach(P),t.__h=t.__h.filter(function(o){return!o.__||A(o)})}catch(o){n.some(function(a){a.__h&&(a.__h=[])}),n=[],i.__e(o,t.__v)}}),I&&I(e,n)},i.unmount=function(e){R&&R(e);var n,t=e.__c;t&&t.__H&&(t.__H.__.forEach(function(o){try{P(o)}catch(a){n=a}}),n&&i.__e(n,t.__v))};var T=typeof requestAnimationFrame=="function";function P(e){var n=u,t=e.__c;typeof t=="function"&&(e.__c=void 0,t()),u=n}function A(e){var n=u;e.__c=e.__(),u=n}function z(e,n){return!e||e.length!==n.length||n.some(function(t,o){return t!==e[o]})}function O(e,n){return typeof n=="function"?n(e):n}var K={NONE:0,GLA:1,PGL:2,MRD:3,LNC:4,ARC:5,CNJ:6,THM:7,CRP:8,BSM:9,ARM:10,GSM:11,LTW:12,WVR:13,ALC:14,CUL:15,MIN:16,BTN:17,FSH:18,PLD:19,MNK:20,WAR:21,DRG:22,BRD:23,WHM:24,BLM:25,ACN:26,SMN:27,SCH:28,ROG:29,NIN:30,MCH:31,DRK:32,AST:33,SAM:34,RDM:35,BLU:36,GNB:37,DNC:38,RPR:39,SGE:40},oe=(e=300)=>new Promise(n=>setTimeout(n,e)),re=(()=>{let e=null;return async()=>{if(e!=null)return e;for(;!window.OverlayPluginApi?.ready;)await oe(300);return e=window.OverlayPluginApi}})(),V=async(e,n)=>{let t=await re();return new Promise(o=>t.callHandler(JSON.stringify(Object.assign(Object.create(null),{call:e},n||{})),o))},ae=async(e,n)=>(window.__OverlayCallback=t=>{t!=null&&n(t)},V("subscribe",{events:e}),()=>V("unsubscribe",{events:e})),J=e=>{let n=Object.keys(e),t=ae(n,o=>{for(let a of n)if(o.type===a){let s=e[a];s?.(o);return}});return()=>t.then(o=>(o(),void 0),()=>{})};var ie=(e,n)=>e!=null&&e.id===n.id&&e.name===n.name,ue=(e,n)=>e!=null&&e.id===n.id&&e.name===n.name,G=f(null),$=f(null),se=f(null),le=f(!1),q=f(null),B=()=>L(G);var b=e=>v(e),ce=(e,n)=>e[0]==="03"&&e[2].toLowerCase()==n.toString(16).toLowerCase()?parseInt(e[4]||"0",16):null,_e=({children:e,defaultJob:n})=>{let t=L($),o=L(q),[a,s]=b(n);return d(()=>{if(t!=null&&o!=null){let _=ce(o,t.id);_!=null&&s(_)}},[t?.id,o]),d(()=>{n!==0&&n!=null&&s(_=>_==null||_===0?n:_)},[n]),r(se.Provider,{value:a},e)},F=({children:e})=>{let[n,t]=b(null),[o,a]=b(null),[s,_]=b(!1),[k,m]=b(null),[h,Y]=b(null);return d(()=>J({ChangeZone:c=>{let l={id:c.zoneID,name:c.zoneName};t(y=>ie(y,l)?y:l)},ChangePrimaryPlayer:c=>{let l={id:c.charID,name:c.charName};a(y=>ue(y,l)?y:l)},onPlayerChangedEvent:c=>{let l=c.detail;l.job!=null&&l.job!=="NONE"&&Y(K[l.job])},onInCombatChangedEvent:c=>{let l=c.detail;_(l.inACTCombat&&l.inGameCombat)},LogLine:c=>{m(c.line)}}),[]),r($.Provider,{value:o},r(G.Provider,{value:n},r(le.Provider,{value:s},r(q.Provider,{value:k},r(_e,{defaultJob:h},e)))))};var me="=",fe=":",W=(e,n)=>n==null?"":`${e}${me}${n}`,j=({zone:e,job:n,inCombat:t})=>[`@${e}`,n!==0?W("job",n):"",W("combat",t?"true":"false")].join(fe);var de="rgba(0,0,0,.3)",Q="rgba(255,255,255,.7)",be=()=>{let e=B(),n=e&&j({zone:e.id}),t=e?.name,[o,a]=v(""),[s,_]=v(!0),k=Z(()=>n!=null&&window.open("./memo.html?key="+encodeURIComponent(n)+(t!=null?"&zone="+encodeURIComponent(t):""),"notepad","width=500,height=400")?.focus(),[n,t]);return d(()=>{if(n==null)return()=>{};a(window.localStorage.getItem(n)||"");let m=h=>{h.key===n&&a(h.newValue||"")};return window.addEventListener("storage",m),()=>window.removeEventListener("storage",m)},[n]),r("div",null,r("div",null,r("button",{class:`button-like ${o!==""&&!s?"accent":""}`,onClick:()=>_(m=>!m)},s?"\uBA54\uBAA8 \uC228\uAE30\uAE30":o===""?"\uBA54\uBAA8":"\uBA54\uBAA8 \uBCF4\uAE30")),s&&r("button",{class:"button-like macro-like",style:{display:"block",textAlign:"start"},onDblClick:k},o||`\uE04E  \uB354\uBE14\uD074\uB9AD\uD574\uC11C ${e?e.name+"\uC5D0\uC11C\uC758 ":" "}\uBA54\uBAA8 \uCD94\uAC00/\uC218\uC815`))},ye=()=>r(be,null),pe=String.raw,Ce=pe`
	.button-like {
		background-color: ${de};
		padding: 10px;
		cursor: pointer;
		color: ${Q};
		transition: 0.2s background-color, 0.2s color;
	}

	.button-like:hover {
		background-color: #000;
		color: #fff;
	}

	.button-like.accent:not(:hover) {
		background-color: rgba(0, 0, 0, 0.7);
	}
`,ve=()=>r("main",{style:{color:Q,inset:0,position:"absolute"}},r("style",null,Ce),r(F,null,r(ye,null))),X=e=>D(r(ve,null),e);X(document.body);
